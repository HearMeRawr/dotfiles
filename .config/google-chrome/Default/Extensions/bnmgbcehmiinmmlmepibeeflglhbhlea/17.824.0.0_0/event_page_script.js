var f,aa="function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={a:!0},ea={};try{ea.__proto__=da;ca=ea.a;break a}catch(a){}ca=!1}ba=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var fa=ba,l=function(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(fa)fa(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype},ha="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},m="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=
global?global:this,ia=function(a,b){if(b){var c=m;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ha(c,a,{configurable:!0,writable:!0,value:b})}};ia("Array.prototype.find",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,g=0;g<e;g++){var h=b[g];if(a.call(c,h,g,b)){a=h;break a}}a=void 0}return a}},"es6","es3");
var ja=function(){ja=function(){};m.Symbol||(m.Symbol=ka)},ka=function(){var a=0;return function(b){return"jscomp_symbol_"+(b||"")+a++}}(),n=function(){ja();var a=m.Symbol.iterator;a||(a=m.Symbol.iterator=m.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&ha(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return la(this)}});n=function(){}},la=function(a){var b=0;return ma(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})},ma=function(a){n();a={next:a};a[m.Symbol.iterator]=
function(){return this};return a},na=function(a){n();var b=a[Symbol.iterator];return b?b.call(a):la(a)},p=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
ia("WeakMap",function(a){function b(a){p(a,d)||ha(a,d,{value:{}})}function c(a){var c=Object[a];c&&(Object[a]=function(a){b(a);return c(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(Rb){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);c("freeze");c("preventExtensions");c("seal");var e=0,g=function(a){this.id_=
(e+=Math.random()+1).toString();if(a){ja();n();a=na(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};g.prototype.set=function(a,c){b(a);if(!p(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=c;return this};g.prototype.get=function(a){return p(a,d)?a[d][this.id_]:void 0};g.prototype.has=function(a){return p(a,d)&&p(a[d],this.id_)};g.prototype.delete=function(a){return p(a,d)&&p(a[d],this.id_)?delete a[d][this.id_]:!1};return g},"es6","es3");
ia("Map",function(a){if(function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a(na([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(te){return!1}}())return a;ja();n();var b=new WeakMap,c=function(a){this.data_={};this.head_=g();
this.size=0;if(a){a=na(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};c.prototype.delete=function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],
a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};c.prototype.has=function(a){return!!d(this,a).entry};c.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};c.prototype.entries=function(){return e(this,function(a){return[a.key,a.value]})};c.prototype.keys=function(){return e(this,function(a){return a.key})};c.prototype.values=function(){return e(this,
function(a){return a.value})};c.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var d=function(a,c){var d=c&&typeof c;"object"==d||"function"==d?b.has(c)?d=b.get(c):(d=""+ ++h,b.set(c,d)):d="p_"+c;var e=a.data_[d];if(e&&p(a.data_,d))for(a=0;a<e.length;a++){var g=e[a];if(c!==c&&g.key!==g.key||c===g.key)return{id:d,list:e,index:a,entry:g}}return{id:d,list:e,index:-1,entry:void 0}},e=function(a,
b){var c=a.head_;return ma(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=a.next=a.head=a},h=0;return c},"es6","es3");
ia("String.prototype.startsWith",function(a){return a?a:function(a,c){if(null==this)throw new TypeError("The 'this' value for String.prototype.startsWith must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype.startsWith must not be a regular expression");var b=this+"";a+="";var e=b.length,g=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var h=0;h<g&&c<e;)if(b[c++]!=a[h++])return!1;return h>=g}},"es6","es3");
ia("Set",function(a){if(function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a(na([b]));if(!d.has(b)||1!=d.size||d.add(b)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var e=d.entries(),g=e.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=e.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:e.next().done}catch(h){return!1}}())return a;ja();n();var b=function(a){this.map_=new Map;if(a){a=na(a);
for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};b.prototype.values=function(){return this.map_.values()};b.prototype.keys=b.prototype.values;
b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6","es3");window.CLOSURE_NO_DEPS=!0;var oa=oa||{},q=this,r=function(a){return void 0!==a},t=function(a){return"string"==typeof a},pa=function(a,b,c){a=a.split(".");c=c||q;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&r(b)?c[d]=b:c=c[d]&&c[d]!==Object.prototype[d]?c[d]:c[d]={}},u=function(){},v=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";
if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==b&&"undefined"==typeof a.call)return"object";return b},qa=function(a){var b=v(a);return"array"==b||"object"==b&&"number"==typeof a.length},x=function(a){return"function"==
v(a)},ra=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b},sa=function(a,b,c){return a.call.apply(a.bind,arguments)},ta=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}},y=function(a,b,c){y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?
sa:ta;return y.apply(null,arguments)},ua=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}},va=Date.now||function(){return+new Date},z=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(a,c,g){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}};var A=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,A);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))};z(A,Error);A.prototype.name="CustomError";var wa=function(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")},xa=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},ya=function(a,b){return a<b?-1:a>b?1:0};var za=function(a,b){b.unshift(a);A.call(this,wa.apply(null,b));b.shift()};z(za,A);za.prototype.name="AssertionError";var B=function(a,b){throw new za("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Aa=Array.prototype.indexOf?function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(t(a))return t(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ba=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=t(a)?a.split(""):a,g=0;g<d;g++)g in e&&b.call(c,e[g],g,a)},Ca=function(a,b,c){a:{for(var d=a.length,e=t(a)?a.split(""):a,g=0;g<
d;g++)if(g in e&&b.call(c,e[g],g,a)){b=g;break a}b=-1}return 0>b?null:t(a)?a.charAt(b):a[b]},Da=function(a,b){b=Aa(a,b);var c;(c=0<=b)&&Array.prototype.splice.call(a,b,1);return c},Ea=function(a){return Array.prototype.concat.apply([],arguments)},Fa=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};var Ga=function(a,b,c){this.limit_=c;this.create_=a;this.reset_=b;this.occupants_=0;this.head_=null};Ga.prototype.get=function(){if(0<this.occupants_){this.occupants_--;var a=this.head_;this.head_=a.next;a.next=null}else a=this.create_();return a};Ga.prototype.put=function(a){this.reset_(a);this.occupants_<this.limit_&&(this.occupants_++,a.next=this.head_,this.head_=a)};var C;a:{var Ha=q.navigator;if(Ha){var Ia=Ha.userAgent;if(Ia){C=Ia;break a}}C=""}var D=function(a){return-1!=C.indexOf(a)};var Ja=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return!0;return!1},Ka=function(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b},La=function(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b},Ma=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d},Na="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Oa=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var g=0;g<Na.length;g++)c=
Na[g],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Pa=function(a){q.setTimeout(function(){throw a;},0)},Qa,Ra=function(){var a=q.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!D("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host;
a=y(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!D("Trident")&&!D("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(r(c.next)){c=c.next;var a=c.cb;c.cb=null;a()}};return function(a){d.next={cb:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){q.setTimeout(a,0)}};var Sa=function(){this.workTail_=this.workHead_=null},Ua=new Ga(function(){return new Ta},function(a){a.reset()},100);Sa.prototype.add=function(a,b){var c=this.getUnusedItem_();c.set(a,b);this.workTail_?this.workTail_.next=c:this.workHead_=c;this.workTail_=c};Sa.prototype.remove=function(){var a=null;this.workHead_&&(a=this.workHead_,this.workHead_=this.workHead_.next,this.workHead_||(this.workTail_=null),a.next=null);return a};Sa.prototype.returnUnused=function(a){Ua.put(a)};
Sa.prototype.getUnusedItem_=function(){return Ua.get()};var Ta=function(){this.next=this.scope=this.fn=null};Ta.prototype.set=function(a,b){this.fn=a;this.scope=b;this.next=null};Ta.prototype.reset=function(){this.next=this.scope=this.fn=null};var E=function(a,b){Va||Wa();Xa||(Va(),Xa=!0);Ya.add(a,b)},Va,Wa=function(){if(-1!=String(q.Promise).indexOf("[native code]")){var a=q.Promise.resolve(void 0);Va=function(){a.then(Za)}}else Va=function(){var a=Za;!x(q.setImmediate)||q.Window&&q.Window.prototype&&!D("Edge")&&q.Window.prototype.setImmediate==q.setImmediate?(Qa||(Qa=Ra()),Qa(a)):q.setImmediate(a)}},Xa=!1,Ya=new Sa,Za=function(){for(var a;a=Ya.remove();){try{a.fn.call(a.scope)}catch(b){Pa(b)}Ya.returnUnused(a)}Xa=!1};var $a=function(a){$a[" "](a);return a};$a[" "]=u;var ab=function(a,b,c,d){d=d?d(b):b;return Object.prototype.hasOwnProperty.call(a,d)?a[d]:a[d]=c(b)};var bb=D("Opera"),F=D("Trident")||D("MSIE"),cb=D("Edge"),db=D("Gecko")&&!(-1!=C.toLowerCase().indexOf("webkit")&&!D("Edge"))&&!(D("Trident")||D("MSIE"))&&!D("Edge"),eb=-1!=C.toLowerCase().indexOf("webkit")&&!D("Edge"),fb=function(){var a=q.document;return a?a.documentMode:void 0},gb;
a:{var hb="",ib=function(){var a=C;if(db)return/rv\:([^\);]+)(\)|;)/.exec(a);if(cb)return/Edge\/([\d\.]+)/.exec(a);if(F)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(eb)return/WebKit\/(\S+)/.exec(a);if(bb)return/(?:Version)[ \/]?(\S+)/.exec(a)}();ib&&(hb=ib?ib[1]:"");if(F){var jb=fb();if(null!=jb&&jb>parseFloat(hb)){gb=String(jb);break a}}gb=hb}
var kb=gb,lb={},G=function(a){return ab(lb,a,function(){for(var b=0,c=xa(String(kb)).split("."),d=xa(String(a)).split("."),e=Math.max(c.length,d.length),g=0;0==b&&g<e;g++){var h=c[g]||"",k=d[g]||"";do{h=/(\d*)(\D*)(.*)/.exec(h)||["","","",""];k=/(\d*)(\D*)(.*)/.exec(k)||["","","",""];if(0==h[0].length&&0==k[0].length)break;b=ya(0==h[1].length?0:parseInt(h[1],10),0==k[1].length?0:parseInt(k[1],10))||ya(0==h[2].length,0==k[2].length)||ya(h[2],k[2]);h=h[3];k=k[3]}while(0==b)}return 0<=b})},mb;
var nb=q.document;mb=nb&&F?fb()||("CSS1Compat"==nb.compatMode?parseInt(kb,10):5):void 0;var H=function(a,b,c,d,e){this.reset(a,b,c,d,e)};H.prototype.exception_=null;var ob=0;H.prototype.reset=function(a,b,c,d,e){"number"==typeof e||ob++;d||va();this.level_=a;this.msg_=b;delete this.exception_};H.prototype.setException=function(a){this.exception_=a};H.prototype.setLevel=function(a){this.level_=a};H.prototype.getMessage=function(){return this.msg_};var pb=function(a){this.name_=a;this.handlers_=this.children_=this.level_=this.parent_=null},I=function(a,b){this.name=a;this.value=b};I.prototype.toString=function(){return this.name};var qb=new I("SEVERE",1E3),rb=new I("WARNING",900),sb=new I("INFO",800),tb=new I("CONFIG",700),ub=new I("FINE",500);f=pb.prototype;f.getName=function(){return this.name_};f.getParent=function(){return this.parent_};f.getChildren=function(){this.children_||(this.children_={});return this.children_};
f.setLevel=function(a){this.level_=a};f.getEffectiveLevel=function(){if(this.level_)return this.level_;if(this.parent_)return this.parent_.getEffectiveLevel();B("Root logger has no level set.");return null};f.isLoggable=function(a){return a.value>=this.getEffectiveLevel().value};f.log=function(a,b,c){this.isLoggable(a)&&(x(b)&&(b=b()),this.doLogRecord_(this.getLogRecord(a,b,c)))};f.getLogRecord=function(a,b,c){a=new H(a,String(b),this.name_);c&&a.setException(c);return a};
f.severe=function(a,b){this.log(qb,a,b)};f.warning=function(a,b){this.log(rb,a,b)};f.info=function(a,b){this.log(sb,a,b)};f.config=function(a,b){this.log(tb,a,b)};f.fine=function(a,b){this.log(ub,a,b)};f.doLogRecord_=function(a){var b="log:"+a.getMessage(),c=q.console;c&&c.timeStamp&&c.timeStamp(b);(c=q.msWriteProfilerMark)&&c(b);for(b=this;b;)b.callPublish_(a),b=b.getParent()};f.callPublish_=function(a){if(this.handlers_)for(var b=0,c;c=this.handlers_[b];b++)c(a)};
f.setParent_=function(a){this.parent_=a};f.addChild_=function(a,b){this.getChildren()[a]=b};var vb={},wb=null,xb=function(a){wb||(wb=new pb(""),vb[""]=wb,wb.setLevel(tb));var b;if(!(b=vb[a])){b=new pb(a);var c=a.lastIndexOf("."),d=a.substr(c+1);c=xb(a.substr(0,c));c.addChild_(d,b);b.setParent_(c);vb[a]=b}return b};var J=function(a,b){a=xb(a);b&&a&&a.setLevel(b);return a},yb=function(a,b,c){a&&a.severe(b,c)},zb=function(a,b,c){a&&a.warning(b,c)},K=function(a,b,c){a&&a.info(b,c)},L=function(a,b,c){a&&a.fine(b,c)};var N=function(a,b){this.state_=0;this.result_=void 0;this.callbackEntriesTail_=this.callbackEntries_=this.parent_=null;this.hadUnhandledRejection_=this.executing_=!1;if(a!=u)try{var c=this;a.call(b,function(a){c.resolve_(2,a)},function(a){if(!(a instanceof M))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(e){}c.resolve_(3,a)})}catch(d){this.resolve_(3,d)}},Ab=function(){this.next=this.context=this.onRejected=this.onFulfilled=this.child=null;this.always=!1};
Ab.prototype.reset=function(){this.context=this.onRejected=this.onFulfilled=this.child=null;this.always=!1};
var Bb=new Ga(function(){return new Ab},function(a){a.reset()},100),Cb=function(a,b,c){var d=Bb.get();d.onFulfilled=a;d.onRejected=b;d.context=c;return d},O=function(a){if(a instanceof N)return a;var b=new N(u);b.resolve_(2,a);return b},Db=function(a){return new N(function(b,c){c(a)})},Fb=function(a,b,c){Eb(a,b,c,null)||E(ua(b,a))},Gb=function(a){return new N(function(b,c){a.length||b(void 0);for(var d=0,e;d<a.length;d++)e=a[d],Fb(e,b,c)})},Hb=function(a){return new N(function(b,c){var d=a.length,
e=[];if(d)for(var g=function(a,c){d--;e[a]=c;0==d&&b(e)},h=function(a){c(a)},k=0,w;k<a.length;k++)w=a[k],Fb(w,ua(g,k),h);else b(e)})},Jb=function(){var a,b,c=new N(function(c,e){a=c;b=e});return new Ib(c,a,b)};N.prototype.then=function(a,b,c){return this.addChildPromise_(x(a)?a:null,x(b)?b:null,c)};N.prototype.then=N.prototype.then;N.prototype.$goog_Thenable=!0;f=N.prototype;f.thenVoid=function(a,b,c){this.addCallbackEntry_(Cb(a||u,b||null,c))};
f.thenAlways=function(a,b){a=Cb(a,a,b);a.always=!0;this.addCallbackEntry_(a);return this};f.thenCatch=function(a,b){return this.addChildPromise_(null,a,b)};f.cancel=function(a){0==this.state_&&E(function(){var b=new M(a);this.cancelInternal_(b)},this)};f.cancelInternal_=function(a){0==this.state_&&(this.parent_?(this.parent_.cancelChild_(this,a),this.parent_=null):this.resolve_(3,a))};
f.cancelChild_=function(a,b){if(this.callbackEntries_){for(var c=0,d=null,e=null,g=this.callbackEntries_;g&&(g.always||(c++,g.child==a&&(d=g),!(d&&1<c)));g=g.next)d||(e=g);d&&(0==this.state_&&1==c?this.cancelInternal_(b):(e?this.removeEntryAfter_(e):this.popEntry_(),this.executeCallback_(d,3,b)))}};f.addCallbackEntry_=function(a){this.hasEntry_()||2!=this.state_&&3!=this.state_||this.scheduleCallbacks_();this.queueEntry_(a)};
f.addChildPromise_=function(a,b,c){var d=Cb(null,null,null);d.child=new N(function(e,g){d.onFulfilled=a?function(b){try{var d=a.call(c,b);e(d)}catch(w){g(w)}}:e;d.onRejected=b?function(a){try{var d=b.call(c,a);!r(d)&&a instanceof M?g(a):e(d)}catch(w){g(w)}}:g});d.child.parent_=this;this.addCallbackEntry_(d);return d.child};f.unblockAndFulfill_=function(a){this.state_=0;this.resolve_(2,a)};f.unblockAndReject_=function(a){this.state_=0;this.resolve_(3,a)};
f.resolve_=function(a,b){0==this.state_&&(this===b&&(a=3,b=new TypeError("Promise cannot resolve to itself")),this.state_=1,Eb(b,this.unblockAndFulfill_,this.unblockAndReject_,this)||(this.result_=b,this.state_=a,this.parent_=null,this.scheduleCallbacks_(),3!=a||b instanceof M||Kb(this,b)))};
var Eb=function(a,b,c,d){if(a instanceof N)return a.thenVoid(b,c,d),!0;if(a)try{var e=!!a.$goog_Thenable}catch(h){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(ra(a))try{var g=a.then;if(x(g))return Lb(a,g,b,c,d),!0}catch(h){return c.call(d,h),!0}return!1},Lb=function(a,b,c,d,e){var g=!1,h=function(a){g||(g=!0,c.call(e,a))},k=function(a){g||(g=!0,d.call(e,a))};try{b.call(a,h,k)}catch(w){k(w)}};f=N.prototype;
f.scheduleCallbacks_=function(){this.executing_||(this.executing_=!0,E(this.executeCallbacks_,this))};f.hasEntry_=function(){return!!this.callbackEntries_};f.queueEntry_=function(a){this.callbackEntriesTail_?this.callbackEntriesTail_.next=a:this.callbackEntries_=a;this.callbackEntriesTail_=a};f.popEntry_=function(){var a=null;this.callbackEntries_&&(a=this.callbackEntries_,this.callbackEntries_=a.next,a.next=null);this.callbackEntries_||(this.callbackEntriesTail_=null);return a};
f.removeEntryAfter_=function(a){a.next==this.callbackEntriesTail_&&(this.callbackEntriesTail_=a);a.next=a.next.next};f.executeCallbacks_=function(){for(var a;a=this.popEntry_();)this.executeCallback_(a,this.state_,this.result_);this.executing_=!1};f.executeCallback_=function(a,b,c){3==b&&a.onRejected&&!a.always&&this.removeUnhandledRejection_();if(a.child)a.child.parent_=null,Mb(a,b,c);else try{a.always?a.onFulfilled.call(a.context):Mb(a,b,c)}catch(d){Nb.call(null,d)}Bb.put(a)};
var Mb=function(a,b,c){2==b?a.onFulfilled.call(a.context,c):a.onRejected&&a.onRejected.call(a.context,c)};N.prototype.removeUnhandledRejection_=function(){var a;for(a=this;a&&a.hadUnhandledRejection_;a=a.parent_)a.hadUnhandledRejection_=!1};var Kb=function(a,b){a.hadUnhandledRejection_=!0;E(function(){a.hadUnhandledRejection_&&Nb.call(null,b)})},Nb=Pa,M=function(a){A.call(this,a)};z(M,A);M.prototype.name="cancel";var Ib=function(a,b,c){this.promise=a;this.resolve=b;this.reject=c};var Ob=function(){return!!(chrome&&chrome.app&&chrome.app.runtime)},P=function(a){var b=a.split("."),c=b.pop(),d=q;b.forEach(function(a){d=d[a]});var e=d[c];return function(b){var c=Array.prototype.slice.call(arguments);return new N(function(b,g){c.push(function(c){if(chrome.runtime.lastError){var d=chrome.runtime.lastError.message,e=J("cv2.ChromeUtilities");yb(e,a+" failed. Reason: "+d);g(Error(d))}else switch(arguments.length){case 0:b(void 0);break;case 1:b(arguments[0]);break;default:b(Array.prototype.slice.call(arguments))}});
e.apply(d,c)})}},Q=function(a,b,c){var d=function(a){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];var k=chrome.runtime.lastError;E(function(){chrome.runtime.lastError=k;b.apply(c,d)});return!0};a.addListener(d);return d};var Pb=function(a){this.topicId_=a};Pb.prototype.toString=function(){return this.topicId_};var R=function(){this.disposed_=this.disposed_;this.onDisposeCallbacks_=this.onDisposeCallbacks_};f=R.prototype;f.disposed_=!1;f.isDisposed=function(){return this.disposed_};f.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())};f.registerDisposable=function(a){this.addOnDisposeCallback(ua(Qb,a))};f.addOnDisposeCallback=function(a,b){this.disposed_?r(b)?a.call(b):a():(this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]),this.onDisposeCallbacks_.push(r(b)?y(a,b):a))};
f.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()};var Qb=function(a){a&&"function"==typeof a.dispose&&a.dispose()};var S=function(a){R.call(this);this.key_=1;this.pendingKeys_=[];this.publishDepth_=0;this.subscriptions_=[];this.topics_={};this.async_=!!a};z(S,R);S.prototype.subscribe=function(a,b,c){var d=this.topics_[a];d||(d=this.topics_[a]=[]);var e=this.key_;this.subscriptions_[e]=a;this.subscriptions_[e+1]=b;this.subscriptions_[e+2]=c;this.key_=e+3;d.push(e);return e};S.prototype.unsubscribe=function(a,b,c){if(a=this.topics_[a]){var d=this.subscriptions_;if(a=Ca(a,function(a){return d[a+1]==b&&d[a+2]==c}))return this.unsubscribeByKey(a)}return!1};
S.prototype.unsubscribeByKey=function(a){var b=this.subscriptions_[a];if(b){var c=this.topics_[b];0!=this.publishDepth_?(this.pendingKeys_.push(a),this.subscriptions_[a+1]=u):(c&&Da(c,a),delete this.subscriptions_[a],delete this.subscriptions_[a+1],delete this.subscriptions_[a+2])}return!!b};
S.prototype.publish=function(a,b){var c=this.topics_[a];if(c){for(var d=Array(arguments.length-1),e=1,g=arguments.length;e<g;e++)d[e-1]=arguments[e];if(this.async_)for(e=0;e<c.length;e++){var h=c[e];Sb(this.subscriptions_[h+1],this.subscriptions_[h+2],d)}else{this.publishDepth_++;try{for(e=0,g=c.length;e<g;e++)h=c[e],this.subscriptions_[h+1].apply(this.subscriptions_[h+2],d)}finally{if(this.publishDepth_--,0<this.pendingKeys_.length&&0==this.publishDepth_)for(;c=this.pendingKeys_.pop();)this.unsubscribeByKey(c)}}return 0!=
e}return!1};var Sb=function(a,b,c){E(function(){a.apply(b,c)})};S.prototype.clear=function(a){if(a){var b=this.topics_[a];b&&(Ba(b,this.unsubscribeByKey,this),delete this.topics_[a])}else this.subscriptions_.length=0,this.topics_={}};S.prototype.getCount=function(a){if(a){var b=this.topics_[a];return b?b.length:0}a=0;for(b in this.topics_)a+=this.getCount(b);return a};S.prototype.disposeInternal=function(){S.superClass_.disposeInternal.call(this);this.clear();this.pendingKeys_.length=0};var T=function(a){R.call(this);this.pubSub_=new S(a);this.registerDisposable(this.pubSub_)};z(T,R);f=T.prototype;f.subscribe=function(a,b,c){return this.pubSub_.subscribe(a.toString(),b,c)};f.unsubscribe=function(a,b,c){return this.pubSub_.unsubscribe(a.toString(),b,c)};f.unsubscribeByKey=function(a){return this.pubSub_.unsubscribeByKey(a)};f.publish=function(a,b){return this.pubSub_.publish(a.toString(),b)};f.clear=function(a){this.pubSub_.clear(r(a)?a.toString():void 0)};
f.getCount=function(a){return this.pubSub_.getCount(r(a)?a.toString():void 0)};var Tb=new Pb("castv2.receiver.chrome.Launch.launch-app"),Ub=function(){T.call(this,!0)};l(Ub,T);Ub.prototype.fireEvent=function(a){this.publish(Tb,a)};var Vb=function(){T.call(this,!0);var a=this;Q(chrome.app.runtime.onLaunched,function(b){a.fireEvent(b.isKioskSession)})};l(Vb,Ub);var Wb=function(){T.call(this,!0);var a=this;Q(chrome.browserAction.onClicked,function(){a.fireEvent(!1)})};l(Wb,Ub);
var Xb=angular.module("castv2.receiver.chrome.AppService",[]).service("appLaunchEventService",Vb),Yb=angular.module("castv2.receiver.chrome.ExtensionService",[]).service("extensionLaunchEventService",Wb),Zb=angular.module("castv2.receiver.chrome.Launch",[Xb.name,Yb.name]).service("launchEventService",Ub).decorator("launchEventService",["$delegate","$injector",function(a,b){var c;Ob()?c="appLaunchEventService":chrome&&chrome.extension?c="extensionLaunchEventService":B("Unknown mode");return b.get(c)}]);var U=function(a){T.call(this,!0);this.id=a};l(U,T);f=U.prototype;f.getState=function(){throw Error("Not Implemented");};f.getBounds=function(){throw Error("Not Implemented");};f.setBounds=function(){throw Error("Not Implemented");};f.setFocus=function(){throw Error("Not Implemented");};f.close=function(){throw Error("Not Implemented");};var $b=new Pb("castv2.receiver.chrome.Window.closed");var ac=function(a){U.call(this,a.id);var b=this;this.logger_=J("cv2.receiver.chrome.AppWindow");this.window_=a;this.onClosedListener_=Q(this.window_.onClosed,function(){return b.onClosed_()})};l(ac,U);f=ac.prototype;f.disposeInternal=function(){U.prototype.disposeInternal.call(this);this.window_.onClosed.removeListener(this.onClosedListener_)};
f.getState=function(){return this.window_.isMinimized()?O("minimized"):this.window_.isFullscreen()?O("fullscreen"):this.window_.isMaximized()?O("maximized"):O("normal")};f.getBounds=function(){var a=this.window_.innerBounds;return O({left:a.left,top:a.top,width:a.width,height:a.height})};
f.setBounds=function(a){var b=this.window_.innerBounds;r(a.left)&&(b.left=a.left);r(a.top)&&(b.top=a.top);r(a.width)&&(b.width=a.width);r(a.height)&&(b.height=a.height);return O({left:b.left,top:b.top,width:b.width,height:b.height})};f.setFocus=function(){this.window_.focus();return O()};f.close=function(){this.window_.close();return O()};f.onClosed_=function(){this.publish($b,this);this.dispose()};var V=function(){R.call(this);this.windows_=new Map};l(V,R);V.prototype.cacheAdd=function(a){var b=this;this.registerDisposable(a);a.subscribe($b,function(a){return b.onClosed(a)});this.windows_.set(a.id,a);return a};V.prototype.cacheGet=function(a){return this.windows_.get(a)};V.prototype.onClosed=function(a){this.windows_.delete(a.id);a.dispose()};var bc=function(){V.call(this);this.create_=P("chrome.app.window.create");this.openTab_=P("chrome.browser.openTab");this.closedWindows_=new Set};l(bc,V);f=bc.prototype;f.create=function(a,b,c,d){var e=this;return this.get(b).then(function(g){return g?g.setFocus().then(function(){return g}):e.create_(a,{id:b,innerBounds:{left:c.left,top:c.top,width:c.width,height:c.height},state:d}).then(function(a){return e.cacheAdd(new ac(a))})})};
f.get=function(a){var b=this.cacheGet(a);if(b)return O(b);a=this.closedWindows_.has(a)?null:chrome.app.window.get(a);return O(a?this.cacheAdd(new ac(a)):null)};f.getCurrent=function(){var a=chrome.app.window.current(),b=this.cacheGet(a.id);return b?O(b):O(this.cacheAdd(new ac(a)))};f.getAll=function(){var a=this;return Hb(chrome.app.window.getAll().map(function(b){return a.get(b.id)})).then(function(a){return a.filter(function(a){return!!a})})};f.openTab=function(a){return this.openTab_({url:a})};
f.closeApp=function(){return this.getAll().then(function(a){return Hb(a.map(function(a){return a.close()}))})};f.cacheAdd=function(a){this.closedWindows_.delete(a.id);return V.prototype.cacheAdd.call(this,a)};f.onClosed=function(a){this.closedWindows_.add(a.id);V.prototype.onClosed.call(this,a)};var cc=angular.module("castv2.receiver.chrome.AppWindowService",[]).service("appWindowService",bc);var dc=!F||9<=Number(mb),ec=F&&!G("9");!eb||G("528");db&&G("1.9b")||F&&G("8")||bb&&G("9.5")||eb&&G("528");db&&!G("8")||F&&G("9");var fc=function(){if(!q.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});q.addEventListener("test",u,b);q.removeEventListener("test",u,b);return a}();var W=function(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=this.propagationStopped_=!1;this.returnValue_=!0};W.prototype.stopPropagation=function(){this.propagationStopped_=!0};W.prototype.preventDefault=function(){this.defaultPrevented=!0;this.returnValue_=!1};var X=function(a,b){W.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.key="";this.charCode=this.keyCode=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.event_=this.state=null;a&&this.init(a,b)};z(X,W);
X.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(db){a:{try{$a(b.nodeName);var e=!0;break a}catch(g){}e=!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;null===d?(this.offsetX=eb||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=eb||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,
this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0);this.button=a.button;this.keyCode=a.keyCode||0;this.key=a.key||"";this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.event_=a;
a.defaultPrevented&&this.preventDefault()};X.prototype.stopPropagation=function(){X.superClass_.stopPropagation.call(this);this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0};X.prototype.preventDefault=function(){X.superClass_.preventDefault.call(this);var a=this.event_;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ec)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var gc="closure_listenable_"+(1E6*Math.random()|0),hc=0;var ic=function(a,b,c,d,e,g){this.listener=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.handler=g;this.key=++hc;this.removed=this.callOnce=!1};ic.prototype.markAsRemoved=function(){this.removed=!0;this.handler=this.src=this.proxy=this.listener=null};var jc=function(a){this.src=a;this.listeners={};this.typeCount_=0};f=jc.prototype;f.add=function(a,b,c,d,e){var g=a.toString();a=this.listeners[g];a||(a=this.listeners[g]=[],this.typeCount_++);var h=kc(a,b,d,e);-1<h?(b=a[h],c||(b.callOnce=!1)):(b=new ic(b,null,this.src,g,!!d,e),b.callOnce=c,a.push(b));return b};
f.remove=function(a,b,c,d){a=a.toString();if(!(a in this.listeners))return!1;var e=this.listeners[a];b=kc(e,b,c,d);return-1<b?(e[b].markAsRemoved(),Array.prototype.splice.call(e,b,1),0==e.length&&(delete this.listeners[a],this.typeCount_--),!0):!1};f.removeByKey=function(a){var b=a.type;if(!(b in this.listeners))return!1;var c=Da(this.listeners[b],a);c&&(a.markAsRemoved(),0==this.listeners[b].length&&(delete this.listeners[b],this.typeCount_--));return c};
f.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.listeners)if(!a||c==a){for(var d=this.listeners[c],e=0;e<d.length;e++)++b,d[e].markAsRemoved();delete this.listeners[c];this.typeCount_--}return b};f.getListener=function(a,b,c,d){a=this.listeners[a.toString()];var e=-1;a&&(e=kc(a,b,c,d));return-1<e?a[e]:null};
f.hasListener=function(a,b){var c=r(a),d=c?a.toString():"",e=r(b);return Ja(this.listeners,function(a){for(var g=0;g<a.length;++g)if(!(c&&a[g].type!=d||e&&a[g].capture!=b))return!0;return!1})};var kc=function(a,b,c,d){for(var e=0;e<a.length;++e){var g=a[e];if(!g.removed&&g.listener==b&&g.capture==!!c&&g.handler==d)return e}return-1};var lc="closure_lm_"+(1E6*Math.random()|0),mc={},nc=0,pc=function(a,b,c,d,e){if(d&&d.once)return oc(a,b,c,d,e);if("array"==v(b)){for(var g=0;g<b.length;g++)pc(a,b[g],c,d,e);return null}c=qc(c);return a&&a[gc]?a.listen(b,c,ra(d)?!!d.capture:!!d,e):rc(a,b,c,!1,d,e)},rc=function(a,b,c,d,e,g){if(!b)throw Error("Invalid event type");var h=ra(e)?!!e.capture:!!e,k=sc(a);k||(a[lc]=k=new jc(a));c=k.add(b,c,d,h,g);if(c.proxy)return c;d=tc();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)fc||(e=h),void 0===
e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(uc(b.toString()),d);else throw Error("addEventListener and attachEvent are unavailable.");nc++;return c},tc=function(){var a=vc,b=dc?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b},oc=function(a,b,c,d,e){if("array"==v(b)){for(var g=0;g<b.length;g++)oc(a,b[g],c,d,e);return null}c=qc(c);return a&&a[gc]?a.listenOnce(b,c,ra(d)?!!d.capture:!!d,e):rc(a,b,c,
!0,d,e)},wc=function(a,b,c,d,e){if("array"==v(b)){for(var g=0;g<b.length;g++)wc(a,b[g],c,d,e);return null}d=ra(d)?!!d.capture:!!d;c=qc(c);if(a&&a[gc])return a.unlisten(b,c,d,e);if(!a)return!1;if(a=sc(a))if(b=a.getListener(b,c,d,e))return xc(b);return!1},xc=function(a){if("number"==typeof a||!a||a.removed)return!1;var b=a.src;if(b&&b[gc])return b.unlistenByKey(a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent&&b.detachEvent(uc(c),d);nc--;(c=sc(b))?(c.removeByKey(a),
0==c.typeCount_&&(c.src=null,b[lc]=null)):a.markAsRemoved();return!0},uc=function(a){return a in mc?mc[a]:mc[a]="on"+a},zc=function(a,b,c,d){var e=!0;if(a=sc(a))if(b=a.listeners[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var g=b[a];g&&g.capture==c&&!g.removed&&(g=yc(g,d),e=e&&!1!==g)}return e},yc=function(a,b){var c=a.listener,d=a.handler||a.src;a.callOnce&&xc(a);return c.call(d,b)},vc=function(a,b){if(a.removed)return!0;if(!dc){if(!b)a:{b=["window","event"];for(var c=q,d=0;d<b.length;d++)if(c=
c[b[d]],null==c){b=null;break a}b=c}d=b;b=new X(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(h){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.propagationStopped_&&0<=e;e--){b.currentTarget=d[e];var g=zc(d[e],a,!0,b);c=c&&g}for(e=0;!b.propagationStopped_&&e<d.length;e++)b.currentTarget=d[e],g=zc(d[e],a,!1,b),c=c&&g}return c}return yc(a,new X(b,
this))},sc=function(a){a=a[lc];return a instanceof jc?a:null},Ac="__closure_events_fn_"+(1E9*Math.random()>>>0),qc=function(a){if(x(a))return a;a[Ac]||(a[Ac]=function(b){return a.handleEvent(b)});return a[Ac]};var Bc=function(){R.call(this);this.eventTargetListeners_=new jc(this);this.actualEventTarget_=this;this.parentEventTarget_=null};z(Bc,R);Bc.prototype[gc]=!0;f=Bc.prototype;f.addEventListener=function(a,b,c,d){pc(this,a,b,c,d)};f.removeEventListener=function(a,b,c,d){wc(this,a,b,c,d)};
f.dispatchEvent=function(a){var b,c=this.parentEventTarget_;if(c)for(b=[];c;c=c.parentEventTarget_)b.push(c);c=this.actualEventTarget_;var d=a.type||a;if(t(a))a=new W(a,c);else if(a instanceof W)a.target=a.target||c;else{var e=a;a=new W(d,c);Oa(a,e)}e=!0;if(b)for(var g=b.length-1;!a.propagationStopped_&&0<=g;g--){var h=a.currentTarget=b[g];e=h.fireListeners(d,!0,a)&&e}a.propagationStopped_||(h=a.currentTarget=c,e=h.fireListeners(d,!0,a)&&e,a.propagationStopped_||(e=h.fireListeners(d,!1,a)&&e));if(b)for(g=
0;!a.propagationStopped_&&g<b.length;g++)h=a.currentTarget=b[g],e=h.fireListeners(d,!1,a)&&e;return e};f.disposeInternal=function(){Bc.superClass_.disposeInternal.call(this);this.removeAllListeners();this.parentEventTarget_=null};f.listen=function(a,b,c,d){return this.eventTargetListeners_.add(String(a),b,!1,c,d)};f.listenOnce=function(a,b,c,d){return this.eventTargetListeners_.add(String(a),b,!0,c,d)};f.unlisten=function(a,b,c,d){return this.eventTargetListeners_.remove(String(a),b,c,d)};
f.unlistenByKey=function(a){return this.eventTargetListeners_.removeByKey(a)};f.removeAllListeners=function(a){return this.eventTargetListeners_?this.eventTargetListeners_.removeAll(a):0};f.fireListeners=function(a,b,c){a=this.eventTargetListeners_.listeners[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var g=a[e];if(g&&!g.removed&&g.capture==b){var h=g.listener,k=g.handler||g.src;g.callOnce&&this.unlistenByKey(g);d=!1!==h.call(k,c)&&d}}return d&&0!=c.returnValue_};
f.getListener=function(a,b,c,d){return this.eventTargetListeners_.getListener(String(a),b,c,d)};f.hasListener=function(a,b){return this.eventTargetListeners_.hasListener(r(a)?String(a):void 0,b)};var Cc="StopIteration"in q?q.StopIteration:{message:"StopIteration",stack:""},Dc=function(){};Dc.prototype.next=function(){throw Cc;};Dc.prototype.__iterator__=function(){return this};var Ec=q.JSON.parse;var Fc=function(){};Fc.prototype.cachedOptions_=null;Fc.prototype.getOptions=function(){return this.cachedOptions_||(this.cachedOptions_=this.internalGetOptions())};var Gc,Hc=function(){};z(Hc,Fc);Hc.prototype.createInstance=function(){var a=this.getProgId_();return a?new ActiveXObject(a):new XMLHttpRequest};Hc.prototype.internalGetOptions=function(){var a={};this.getProgId_()&&(a[0]=!0,a[1]=!0);return a};
Hc.prototype.getProgId_=function(){if(!this.ieProgId_&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],b=0;b<a.length;b++){var c=a[b];try{return new ActiveXObject(c),this.ieProgId_=c}catch(d){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return this.ieProgId_};Gc=new Hc;var Ic=function(a,b){this.map_={};this.keys_=[];this.version_=this.count_=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.addAll(a)};f=Ic.prototype;f.getCount=function(){return this.count_};f.getValues=function(){this.cleanupKeysArray_();for(var a=[],b=0;b<this.keys_.length;b++)a.push(this.map_[this.keys_[b]]);return a};f.getKeys=function(){this.cleanupKeysArray_();return this.keys_.concat()};
f.containsKey=function(a){return Jc(this.map_,a)};f.equals=function(a,b){if(this===a)return!0;if(this.count_!=a.getCount())return!1;b=b||Kc;this.cleanupKeysArray_();for(var c,d=0;c=this.keys_[d];d++)if(!b(this.get(c),a.get(c)))return!1;return!0};var Kc=function(a,b){return a===b};f=Ic.prototype;f.clear=function(){this.map_={};this.version_=this.count_=this.keys_.length=0};
f.remove=function(a){return Jc(this.map_,a)?(delete this.map_[a],this.count_--,this.version_++,this.keys_.length>2*this.count_&&this.cleanupKeysArray_(),!0):!1};f.cleanupKeysArray_=function(){if(this.count_!=this.keys_.length){for(var a=0,b=0;a<this.keys_.length;){var c=this.keys_[a];Jc(this.map_,c)&&(this.keys_[b++]=c);a++}this.keys_.length=b}if(this.count_!=this.keys_.length){var d={};for(b=a=0;a<this.keys_.length;)c=this.keys_[a],Jc(d,c)||(this.keys_[b++]=c,d[c]=1),a++;this.keys_.length=b}};
f.get=function(a,b){return Jc(this.map_,a)?this.map_[a]:b};f.set=function(a,b){Jc(this.map_,a)||(this.count_++,this.keys_.push(a),this.version_++);this.map_[a]=b};f.addAll=function(a){if(a instanceof Ic){var b=a.getKeys();a=a.getValues()}else b=La(a),a=Ka(a);for(var c=0;c<b.length;c++)this.set(b[c],a[c])};f.forEach=function(a,b){for(var c=this.getKeys(),d=0;d<c.length;d++){var e=c[d],g=this.get(e);a.call(b,g,e,this)}};f.clone=function(){return new Ic(this)};
f.__iterator__=function(a){this.cleanupKeysArray_();var b=0,c=this.version_,d=this,e=new Dc;e.next=function(){if(c!=d.version_)throw Error("The map has changed since the iterator was created");if(b>=d.keys_.length)throw Cc;var e=d.keys_[b++];return a?e:d.map_[e]};return e};var Jc=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var Lc=function(a){if(a.getValues&&"function"==typeof a.getValues)return a.getValues();if(t(a))return a.split("");if(qa(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Ka(a)},Mc=function(a){if(a.getKeys&&"function"==typeof a.getKeys)return a.getKeys();if(!a.getValues||"function"!=typeof a.getValues){if(qa(a)||t(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return La(a)}},Nc=function(a,b,c){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,c);else if(qa(a)||
t(a))Ba(a,b,c);else for(var d=Mc(a),e=Lc(a),g=e.length,h=0;h<g;h++)b.call(c,e[h],d&&d[h],a)};var Oc=function(a,b,c){if(x(a))c&&(a=y(a,c));else if(a&&"function"==typeof a.handleEvent)a=y(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:q.setTimeout(a,b||0)},Pc=function(a,b){var c=null;return(new N(function(d,e){c=Oc(function(){d(b)},a);-1==c&&e(Error("Failed to schedule timer."))})).thenCatch(function(a){q.clearTimeout(c);throw a;})};var Qc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,Rc=function(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var g=a[c].substring(0,d);e=a[c].substring(d+1)}else g=a[c];b(g,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}};var Y=function(a){Bc.call(this);this.headers=new Ic;this.xmlHttpFactory_=a||null;this.active_=!1;this.xhrOptions_=this.xhr_=null;this.lastError_=this.lastMethod_=this.lastUri_="";this.inAbort_=this.inOpen_=this.inSend_=this.errorDispatched_=!1;this.timeoutInterval_=0;this.timeoutId_=null;this.responseType_="";this.useXhr2Timeout_=this.progressEventsEnabled_=this.withCredentials_=!1};z(Y,Bc);Y.prototype.logger_=J("goog.net.XhrIo");
var Sc=/^https?$/i,Tc=["POST","PUT"],Uc=[],Vc=function(a,b,c,d,e,g,h){var k=new Y;Uc.push(k);b&&k.listen("complete",b);k.listenOnce("ready",k.cleanupSend_);g&&k.setTimeoutInterval(g);h&&k.setWithCredentials(h);k.send(a,c,d,e);return k};Y.prototype.cleanupSend_=function(){this.dispose();Da(Uc,this)};Y.prototype.setTimeoutInterval=function(a){this.timeoutInterval_=Math.max(0,a)};Y.prototype.setWithCredentials=function(a){this.withCredentials_=a};
Y.prototype.send=function(a,b,c,d){if(this.xhr_)throw Error("[goog.net.XhrIo] Object is active with another request="+this.lastUri_+"; newUri="+a);b=b?b.toUpperCase():"GET";this.lastUri_=a;this.lastError_="";this.lastMethod_=b;this.errorDispatched_=!1;this.active_=!0;this.xhr_=this.createXhr();this.xhrOptions_=this.xmlHttpFactory_?this.xmlHttpFactory_.getOptions():Gc.getOptions();this.xhr_.onreadystatechange=y(this.onReadyStateChange_,this);this.progressEventsEnabled_&&"onprogress"in this.xhr_&&(this.xhr_.onprogress=
y(function(a){this.onProgressHandler_(a,!0)},this),this.xhr_.upload&&(this.xhr_.upload.onprogress=y(this.onProgressHandler_,this)));try{L(this.logger_,this.formatMsg_("Opening Xhr")),this.inOpen_=!0,this.xhr_.open(b,String(a),!0),this.inOpen_=!1}catch(g){L(this.logger_,this.formatMsg_("Error opening Xhr: "+g.message));this.error_(5,g);return}a=c||"";var e=this.headers.clone();d&&Nc(d,function(a,b){e.set(b,a)});d=Ca(e.getKeys(),Wc);c=q.FormData&&a instanceof q.FormData;!(0<=Aa(Tc,b))||d||c||e.set("Content-Type",
"application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(a,b){this.xhr_.setRequestHeader(b,a)},this);this.responseType_&&(this.xhr_.responseType=this.responseType_);"withCredentials"in this.xhr_&&this.xhr_.withCredentials!==this.withCredentials_&&(this.xhr_.withCredentials=this.withCredentials_);try{this.cleanUpTimeoutTimer_(),0<this.timeoutInterval_&&(this.useXhr2Timeout_=Xc(this.xhr_),L(this.logger_,this.formatMsg_("Will abort after "+this.timeoutInterval_+"ms if incomplete, xhr2 "+
this.useXhr2Timeout_)),this.useXhr2Timeout_?(this.xhr_.timeout=this.timeoutInterval_,this.xhr_.ontimeout=y(this.timeout_,this)):this.timeoutId_=Oc(this.timeout_,this.timeoutInterval_,this)),L(this.logger_,this.formatMsg_("Sending request")),this.inSend_=!0,this.xhr_.send(a),this.inSend_=!1}catch(g){L(this.logger_,this.formatMsg_("Send error: "+g.message)),this.error_(5,g)}};var Xc=function(a){return F&&G(9)&&"number"==typeof a.timeout&&r(a.ontimeout)},Wc=function(a){return"content-type"==a.toLowerCase()};
f=Y.prototype;f.createXhr=function(){return this.xmlHttpFactory_?this.xmlHttpFactory_.createInstance():Gc.createInstance()};f.timeout_=function(){"undefined"!=typeof oa&&this.xhr_&&(this.lastError_="Timed out after "+this.timeoutInterval_+"ms, aborting",L(this.logger_,this.formatMsg_(this.lastError_)),this.dispatchEvent("timeout"),this.abort(8))};f.error_=function(a,b){this.active_=!1;this.xhr_&&(this.inAbort_=!0,this.xhr_.abort(),this.inAbort_=!1);this.lastError_=b;this.dispatchErrors_();this.cleanUpXhr_()};
f.dispatchErrors_=function(){this.errorDispatched_||(this.errorDispatched_=!0,this.dispatchEvent("complete"),this.dispatchEvent("error"))};f.abort=function(){this.xhr_&&this.active_&&(L(this.logger_,this.formatMsg_("Aborting")),this.active_=!1,this.inAbort_=!0,this.xhr_.abort(),this.inAbort_=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),this.cleanUpXhr_())};
f.disposeInternal=function(){this.xhr_&&(this.active_&&(this.active_=!1,this.inAbort_=!0,this.xhr_.abort(),this.inAbort_=!1),this.cleanUpXhr_(!0));Y.superClass_.disposeInternal.call(this)};f.onReadyStateChange_=function(){if(!this.isDisposed())if(this.inOpen_||this.inSend_||this.inAbort_)this.onReadyStateChangeHelper_();else this.onReadyStateChangeEntryPoint_()};f.onReadyStateChangeEntryPoint_=function(){this.onReadyStateChangeHelper_()};
f.onReadyStateChangeHelper_=function(){if(this.active_&&"undefined"!=typeof oa)if(this.xhrOptions_[1]&&4==this.getReadyState()&&2==this.getStatus())L(this.logger_,this.formatMsg_("Local request error detected and ignored"));else if(this.inSend_&&4==this.getReadyState())Oc(this.onReadyStateChange_,0,this);else if(this.dispatchEvent("readystatechange"),this.isComplete()){L(this.logger_,this.formatMsg_("Request complete"));this.active_=!1;try{this.isSuccess()?(this.dispatchEvent("complete"),this.dispatchEvent("success")):
(this.lastError_=this.getStatusText()+" ["+this.getStatus()+"]",this.dispatchErrors_())}finally{this.cleanUpXhr_()}}};f.onProgressHandler_=function(a,b){this.dispatchEvent(Yc(a,"progress"));this.dispatchEvent(Yc(a,b?"downloadprogress":"uploadprogress"))};var Yc=function(a,b){return{type:b,lengthComputable:a.lengthComputable,loaded:a.loaded,total:a.total}};f=Y.prototype;
f.cleanUpXhr_=function(a){if(this.xhr_){this.cleanUpTimeoutTimer_();var b=this.xhr_,c=this.xhrOptions_[0]?u:null;this.xhrOptions_=this.xhr_=null;a||this.dispatchEvent("ready");try{b.onreadystatechange=c}catch(d){yb(this.logger_,"Problem encountered resetting onreadystatechange: "+d.message)}}};f.cleanUpTimeoutTimer_=function(){this.xhr_&&this.useXhr2Timeout_&&(this.xhr_.ontimeout=null);"number"==typeof this.timeoutId_&&(q.clearTimeout(this.timeoutId_),this.timeoutId_=null)};
f.isComplete=function(){return 4==this.getReadyState()};f.isSuccess=function(){var a=this.getStatus();a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1}return b||0===a&&!this.isLastUriEffectiveSchemeHttp_()};f.isLastUriEffectiveSchemeHttp_=function(){var a=String(this.lastUri_).match(Qc)[1]||null;!a&&q.self&&q.self.location&&(a=q.self.location.protocol,a=a.substr(0,a.length-1));return Sc.test(a?a.toLowerCase():"")};
f.getReadyState=function(){return this.xhr_?this.xhr_.readyState:0};f.getStatus=function(){try{return 2<this.getReadyState()?this.xhr_.status:-1}catch(a){return-1}};f.getStatusText=function(){try{return 2<this.getReadyState()?this.xhr_.statusText:""}catch(a){return L(this.logger_,"Can not get status: "+a.message),""}};f.getResponseText=function(){try{return this.xhr_?this.xhr_.responseText:""}catch(a){return L(this.logger_,"Can not get responseText: "+a.message),""}};
f.getResponseJson=function(a){if(this.xhr_){var b=this.xhr_.responseText;a&&0==b.indexOf(a)&&(b=b.substring(a.length));return Ec(b)}};f.getResponseHeader=function(a){if(this.xhr_&&this.isComplete())return a=this.xhr_.getResponseHeader(a),null===a?void 0:a};f.getAllResponseHeaders=function(){return this.xhr_&&this.isComplete()?this.xhr_.getAllResponseHeaders():""};f.getLastError=function(){return t(this.lastError_)?this.lastError_:String(this.lastError_)};
f.formatMsg_=function(a){return a+" ["+this.lastMethod_+" "+this.lastUri_+" "+this.getStatus()+"]"};var Zc=function(a,b){this.domain_=this.userInfo_=this.scheme_="";this.port_=null;this.fragment_=this.path_="";this.ignoreCase_=this.isReadOnly_=!1;var c;a instanceof Zc?(this.ignoreCase_=r(b)?b:a.ignoreCase_,this.setScheme(a.scheme_),this.setUserInfo(a.userInfo_),this.setDomain(a.domain_),this.setPort(a.port_),this.setPath(a.path_),this.setQueryData(a.queryData_.clone()),this.setFragment(a.fragment_)):a&&(c=String(a).match(Qc))?(this.ignoreCase_=!!b,this.setScheme(c[1]||"",!0),this.setUserInfo(c[2]||
"",!0),this.setDomain(c[3]||"",!0),this.setPort(c[4]),this.setPath(c[5]||"",!0),this.setQueryData(c[6]||"",!0),this.setFragment(c[7]||"",!0)):(this.ignoreCase_=!!b,this.queryData_=new Z(null,null,this.ignoreCase_))};f=Zc.prototype;
f.toString=function(){var a=[],b=this.scheme_;b&&a.push($c(b,ad,!0),":");var c=this.domain_;if(c||"file"==b)a.push("//"),(b=this.userInfo_)&&a.push($c(b,ad,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.port_,null!=c&&a.push(":",String(c));if(c=this.path_)this.hasDomain()&&"/"!=c.charAt(0)&&a.push("/"),a.push($c(c,"/"==c.charAt(0)?bd:cd,!0));(c=this.getEncodedQuery())&&a.push("?",c);(c=this.fragment_)&&a.push("#",$c(c,dd));return a.join("")};
f.resolve=function(a){var b=this.clone(),c=a.hasScheme();c?b.setScheme(a.scheme_):c=a.hasUserInfo();c?b.setUserInfo(a.userInfo_):c=a.hasDomain();c?b.setDomain(a.domain_):c=a.hasPort();var d=a.path_;if(c)b.setPort(a.port_);else if(c=a.hasPath()){if("/"!=d.charAt(0))if(this.hasDomain()&&!this.hasPath())d="/"+d;else{var e=b.path_.lastIndexOf("/");-1!=e&&(d=b.path_.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=0==e.lastIndexOf("/",0);e=e.split("/");for(var g=
[],h=0;h<e.length;){var k=e[h++];"."==k?d&&h==e.length&&g.push(""):".."==k?((1<g.length||1==g.length&&""!=g[0])&&g.pop(),d&&h==e.length&&g.push("")):(g.push(k),d=!0)}d=g.join("/")}else d=e}c?b.setPath(d):c=a.hasQuery();c?b.setQueryData(a.queryData_.clone()):c=a.hasFragment();c&&b.setFragment(a.fragment_);return b};f.clone=function(){return new Zc(this)};f.setScheme=function(a,b){this.enforceReadOnly();if(this.scheme_=b?ed(a,!0):a)this.scheme_=this.scheme_.replace(/:$/,"");return this};
f.hasScheme=function(){return!!this.scheme_};f.setUserInfo=function(a,b){this.enforceReadOnly();this.userInfo_=b?ed(a):a;return this};f.hasUserInfo=function(){return!!this.userInfo_};f.setDomain=function(a,b){this.enforceReadOnly();this.domain_=b?ed(a,!0):a;return this};f.hasDomain=function(){return!!this.domain_};f.setPort=function(a){this.enforceReadOnly();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.port_=a}else this.port_=null;return this};
f.hasPort=function(){return null!=this.port_};f.setPath=function(a,b){this.enforceReadOnly();this.path_=b?ed(a,!0):a;return this};f.hasPath=function(){return!!this.path_};f.hasQuery=function(){return""!==this.queryData_.toString()};f.setQueryData=function(a,b){this.enforceReadOnly();a instanceof Z?(this.queryData_=a,this.queryData_.setIgnoreCase(this.ignoreCase_)):(b||(a=$c(a,fd)),this.queryData_=new Z(a,null,this.ignoreCase_));return this};f.getEncodedQuery=function(){return this.queryData_.toString()};
f.setFragment=function(a,b){this.enforceReadOnly();this.fragment_=b?ed(a):a;return this};f.hasFragment=function(){return!!this.fragment_};f.removeParameter=function(a){this.enforceReadOnly();this.queryData_.remove(a);return this};f.enforceReadOnly=function(){if(this.isReadOnly_)throw Error("Tried to modify a read-only Uri");};f.setIgnoreCase=function(a){this.ignoreCase_=a;this.queryData_&&this.queryData_.setIgnoreCase(a);return this};
var gd=function(a,b){return a instanceof Zc?a.clone():new Zc(a,b)},ed=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},$c=function(a,b,c){return t(a)?(a=encodeURI(a).replace(b,hd),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},hd=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},ad=/[#\/\?@]/g,cd=/[\#\?:]/g,bd=/[\#\?]/g,fd=/[\#\?@]/g,dd=/#/g,Z=function(a,b,c){this.count_=this.keyMap_=null;this.encodedQuery_=a||null;
this.ignoreCase_=!!c};Z.prototype.ensureKeyMapInitialized_=function(){if(!this.keyMap_&&(this.keyMap_=new Ic,this.count_=0,this.encodedQuery_)){var a=this;Rc(this.encodedQuery_,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var id=function(a,b,c){b=Mc(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new Z(null,null,c);a=Lc(a);for(var d=0;d<b.length;d++){var e=b[d],g=a[d];"array"==v(g)?c.setValues(e,g):c.add(e,g)}return c};f=Z.prototype;
f.getCount=function(){this.ensureKeyMapInitialized_();return this.count_};f.add=function(a,b){this.ensureKeyMapInitialized_();this.invalidateCache_();a=this.getKeyName_(a);var c=this.keyMap_.get(a);c||this.keyMap_.set(a,c=[]);c.push(b);this.count_+=1;return this};f.remove=function(a){this.ensureKeyMapInitialized_();a=this.getKeyName_(a);return this.keyMap_.containsKey(a)?(this.invalidateCache_(),this.count_-=this.keyMap_.get(a).length,this.keyMap_.remove(a)):!1};
f.clear=function(){this.invalidateCache_();this.keyMap_=null;this.count_=0};f.containsKey=function(a){this.ensureKeyMapInitialized_();a=this.getKeyName_(a);return this.keyMap_.containsKey(a)};f.forEach=function(a,b){this.ensureKeyMapInitialized_();this.keyMap_.forEach(function(c,d){Ba(c,function(c){a.call(b,c,d,this)},this)},this)};
f.getKeys=function(){this.ensureKeyMapInitialized_();for(var a=this.keyMap_.getValues(),b=this.keyMap_.getKeys(),c=[],d=0;d<b.length;d++)for(var e=a[d],g=0;g<e.length;g++)c.push(b[d]);return c};f.getValues=function(a){this.ensureKeyMapInitialized_();var b=[];if(t(a))this.containsKey(a)&&(b=Ea(b,this.keyMap_.get(this.getKeyName_(a))));else{a=this.keyMap_.getValues();for(var c=0;c<a.length;c++)b=Ea(b,a[c])}return b};
f.set=function(a,b){this.ensureKeyMapInitialized_();this.invalidateCache_();a=this.getKeyName_(a);this.containsKey(a)&&(this.count_-=this.keyMap_.get(a).length);this.keyMap_.set(a,[b]);this.count_+=1;return this};f.get=function(a,b){a=a?this.getValues(a):[];return 0<a.length?String(a[0]):b};f.setValues=function(a,b){this.remove(a);0<b.length&&(this.invalidateCache_(),this.keyMap_.set(this.getKeyName_(a),Fa(b)),this.count_+=b.length)};
f.toString=function(){if(this.encodedQuery_)return this.encodedQuery_;if(!this.keyMap_)return"";for(var a=[],b=this.keyMap_.getKeys(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.getValues(d);for(var g=0;g<d.length;g++){var h=e;""!==d[g]&&(h+="="+encodeURIComponent(String(d[g])));a.push(h)}}return this.encodedQuery_=a.join("&")};f.invalidateCache_=function(){this.encodedQuery_=null};
f.clone=function(){var a=new Z;a.encodedQuery_=this.encodedQuery_;this.keyMap_&&(a.keyMap_=this.keyMap_.clone(),a.count_=this.count_);return a};f.getKeyName_=function(a){a=String(a);this.ignoreCase_&&(a=a.toLowerCase());return a};f.setIgnoreCase=function(a){a&&!this.ignoreCase_&&(this.ensureKeyMapInitialized_(),this.invalidateCache_(),this.keyMap_.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),this.setValues(b,a))},this));this.ignoreCase_=a};
f.extend=function(a){for(var b=0;b<arguments.length;b++)Nc(arguments[b],function(a,b){this.add(b,a)},this)};var jd=function(a,b,c){this.accessToken=a||"";this.expiresOn=b||0;this.refreshToken=c||""},kd=function(a,b){return a||b?a&&b&&a.accessToken==b.accessToken&&a.expiresOn==b.expiresOn&&a.refreshToken==b.refreshToken?!0:!1:!0},nd=function(a){this.logger_=J("cv2.cloud.OAuthClient");this.cloudConfig_=a};f=nd.prototype;f.requestAccessToken=function(a){return this.isAlmostExpired_(a)?this.refreshAccessToken_(a.refreshToken):O(a)};
f.refreshAccessToken_=function(a){return this.sendOAuthXhr_({refresh_token:a,grant_type:"refresh_token"}).then(function(b){b.refreshToken||(b.refreshToken=a);return b})};f.sendOAuthXhr_=function(a){var b=this;a.client_id=this.cloudConfig_.appClientID;this.cloudConfig_.appClientSecret&&(a.client_secret=this.cloudConfig_.appClientSecret);return new N(function(c,d){var e=Vc(b.cloudConfig_.oauth2TokenUrl,function(){b.makeOAuthResult_(e,c,d)},"POST",id(a).toString(),{"Content-Type":"application/x-www-form-urlencoded"})})};
f.makeOAuthResult_=function(a,b,c){if(a.isSuccess()){var d=null;""!=a.getResponseText()&&(d=a.getResponseJson());a=new jd;d&&(d.refresh_token||d.access_token)?(d.refresh_token&&(a.refreshToken=d.refresh_token),d.access_token&&(a.accessToken=d.access_token,a.expiresOn=va()+1E3*d.expires_in),b(a)):(K(this.logger_,"Failed to retrieve access token."),c(Error("Failed to retrieve access token.")))}else b="XHR failed: "+a.getLastError(),zb(this.logger_,b),c(Error(b))};
f.revokeToken=function(a){var b=this;return new N(function(c,d){var e=gd(b.cloudConfig_.oauth2RevokeUrl).setQueryData("token="+a),g=Vc(e.toString(),function(){if(g.isSuccess())c();else{var a="XHR failed: "+g.getLastError();zb(b.logger_,a);d(Error(a))}})})};f.isAlmostExpired_=function(a){return 0!=a.expiresOn&&va()+6E5>a.expiresOn};nd.$inject=["cloudConfig"];if("undefined"!=typeof angular)var od=angular.module("castv2.cloud.oauthClient",[]).service("oauthClient",nd);var pd=function(){this.logger_=J("cv2.receiver.storage.StorageService")};f=pd.prototype;f.storeDeviceOAuth=function(a,b){if(r(b)&&kd(a,b))return O();K(this.logger_,"Storing device OAuth credentials.");b={};b.device_oauth=JSON.stringify(a);return this.storeItem_(b)};f.getDeviceOAuth=function(){return this.getItem_("device_oauth").then(function(a){return a.device_oauth?JSON.parse(a.device_oauth):null})};
f.getLegacyDeviceOAuth=function(){return this.getItem_("dva").then(function(a){return a.dva?JSON.parse(a.dva):null})};f.getDeviceId=function(){return this.getItem_("device_id").then(function(a){return a.device_id||null})};f.deleteDeviceId=function(){return this.deleteItem_("device_id")};f.getLegacyDeviceId=function(){return this.getItem_("receiver").then(function(a){return a.receiver||null})};f.deleteLegacyDeviceId=function(){return this.deleteItem_("receiver")};
f.storeUserAuthTokens=function(a,b){if(r(b)&&kd(a,b))return O();K(this.logger_,"Storing user OAuth credentials.");b={};b.ua=JSON.stringify(a);return this.storeItem_(b)};f.getUserAuthTokens=function(){return this.getItem_("ua").then(function(a){return a.ua?JSON.parse(a.ua):null})};f.deleteUserAuthTokens=function(){return this.deleteItem_("ua")};f.storeSessionId=function(a,b){var c={};a=(c["session:"+a]=b,c);return this.storeItem_(a)};
f.getSessionId=function(a){var b="session:"+a;return this.getItem_(b).then(function(a){return a[b]||null})};f.deleteSessionId=function(a){return this.deleteItem_("session:"+a)};f.storeBrowserId=function(a,b){var c={};a=(c["window:"+a]=b,c);return this.storeItem_(a)};f.getBrowserId=function(a){var b="window:"+a;return this.getItem_(b).then(function(a){return a[b]||null})};
f.getAllBrowserIds=function(){return this.getItem_(null).then(function(a){var b={},c;for(c in a)c.startsWith("window:")&&(b[c.substring(7)]=a[c]);return b})};f.deleteBrowserId=function(a){return this.deleteItem_("window:"+a)};f.getForceLaunch=function(){return this.getItem_("force-launch").then(function(a){return a["force-launch"]||!1})};f.deleteForceLaunch=function(){return this.deleteItem_("force-launch")};f.getAll=function(){return P("chrome.storage.local.get")()};f.deleteAll=function(){return P("chrome.storage.local.clear")()};
f.storeItem_=function(a){var b=this;return this.storeSingle_(a).thenCatch(function(){return b.storeSingle_(a)})};f.storeSingle_=function(a){return P("chrome.storage.local.set")(a)};f.getItem_=function(a){return P("chrome.storage.local.get")(a)};f.deleteItem_=function(a){return P("chrome.storage.local.remove")(a)};if("undefined"!=typeof angular)var qd=angular.module("castv2.receiver.storage",[]).service("storage",pd);var rd=function(a,b){U.call(this,b||a.id.toString());var c=this;this.logger_=J("cv2.receiver.chrome.ExtensionWindow");this.windowId=a.id;this.tabId_=(a=a.tabs&&a.tabs.length?a.tabs[0]:null)&&a.id;this.url=a&&a.url;K(this.logger_,"Associating "+this.id+" with chrome window "+this.windowId);this.get_=P("chrome.windows.get");this.remove_=P("chrome.windows.remove");this.update_=P("chrome.windows.update");this.onClosedListener_=Q(chrome.windows.onRemoved,function(a){return c.onRemoved_(a)});this.onTabUpdatedListener_=
Q(chrome.tabs.onUpdated,function(a,b,g){return c.onTabUpdated_(a,b,g)})};l(rd,U);f=rd.prototype;f.disposeInternal=function(){U.prototype.disposeInternal.call(this);chrome.tabs.onUpdated.removeListener(this.onTabUpdatedListener_);chrome.windows.onRemoved.removeListener(this.onClosedListener_)};f.getState=function(){return this.get_(this.windowId).then(function(a){return a.state})};f.getBounds=function(){return this.get_(this.windowId).then(function(a){return{left:a.left,top:a.top,width:a.width,height:a.height}})};
f.setBounds=function(a){return this.update_(this.windowId,{left:a.left,top:a.top,width:a.width,height:a.height}).then(function(a){return{left:a.left,top:a.top,width:a.width,height:a.height}})};f.setFocus=function(){K(this.logger_,"Setting focus to "+this.id+"("+this.windowId+")");return this.update_(this.windowId,{focused:!0})};f.close=function(){return this.remove_(this.windowId)};
f.onRemoved_=function(a){a==this.windowId&&(K(this.logger_,this.id+"("+this.windowId+") is closed"),this.publish($b,this),this.dispose())};f.onTabUpdated_=function(a,b){a==this.tabId_&&(a=b.url)&&a!=this.url&&(K(this.logger_,"Changing url of "+this.id+" to "+a),this.url=a)};var sd=function(a){V.call(this);this.storage_=a;this.logger_=J("cv2.receiver.chrome.ExtensionWindowService");this.chromeCreate_=P("chrome.windows.create");this.get_=P("chrome.windows.get");this.getCurrent_=P("chrome.windows.getCurrent");this.getRecentlyClosed_=P("chrome.sessions.getRecentlyClosed");this.restore_=P("chrome.sessions.restore");this.createTab_=P("chrome.tabs.create")};l(sd,V);f=sd.prototype;
f.create=function(a,b,c,d){var e=this;K(this.logger_,"create("+a+", "+b+")");return this.get(b).then(function(g){return g?g.setFocus().then(function(){return g}):e.storage_.getSessionId(b).then(function(g){return g?e.restore_(g).then(function(a){K(e.logger_,"Restoring "+b+" from session "+g);return e.addWindow_(a.window,b)},function(h){zb(e.logger_,"Failed to restore session "+g+". Reason = "+h.message+". Creating new window.");return e.storage_.deleteSessionId(b).then(function(){return e.create_(a,
b,c,d)})}):e.create_(a,b,c,d)})})};f.get=function(a){var b=this,c=this.cacheGet(a);return c?O(c):this.storage_.getBrowserId(a).then(function(c){return c?b.get_(c).then(function(c){return b.cacheAdd(new rd(c,a))},function(){return b.storage_.deleteBrowserId(a).then(function(){return null})}):null})};f.getCurrent=function(){var a=this;return this.getCurrent_().then(function(b){return b?a.getPersistentId_(b.id).then(function(c){var d=c&&a.cacheGet(c);return d?d:a.cacheAdd(new rd(b,c||void 0))}):null})};
f.getAll=function(){var a=this;return this.storage_.getAllBrowserIds().then(function(b){return Hb(Object.keys(b).map(function(b){return a.get(b)}))})};f.openTab=function(a){var b=this;return this.createTab_({url:a,active:!0}).then(function(a){K(b.logger_,"Opened "+URL+" in tab "+a.id+" in window "+a.windowId)})};f.closeApp=function(){return this.getAll().then(function(a){return Hb(a.map(function(a){return a?a.close():O()}))})};
f.onClosed=function(a){var b=this;V.prototype.onClosed.call(this,a);K(this.logger_,"Removing "+a.id+"("+a.windowId+")");this.storage_.deleteBrowserId(a.id).then(function(){b.getRecentlyClosed_().then(function(c){(c=c.find(function(b){return b.window&&b.window.tabs&&b.window.tabs.length&&b.window.tabs[0].url==a.url}))?(K(b.logger_,"Storing session id "+c.window.sessionId+" for window "+a.id),b.storage_.storeSessionId(a.id,c.window.sessionId)):(zb(b.logger_,"Couldn't find a session for "+a.id),b.storage_.deleteSessionId(a.id))})})};
f.create_=function(a,b,c,d){var e=this;return this.chromeCreate_({url:a,left:c.left,top:c.top,width:c.width,height:c.height,type:"popup",state:d}).then(function(c){K(e.logger_,"Created "+b+"("+c.id+") containing "+a);return e.addWindow_(c,b)})};f.addWindow_=function(a,b){var c=this;return this.storage_.storeBrowserId(b,a.id).then(function(){return c.cacheAdd(new rd(a,b))})};
f.getPersistentId_=function(a){return this.storage_.getAllBrowserIds().then(function(b){return Ma(b,function(b){return b==a})||null})};sd.$inject=["storage"];var td=angular.module("castv2.receiver.chrome.ExtensionWindowService",[qd.name]).service("extensionWindowService",sd);var ud=angular.module("castv2.receiver.chrome.WindowService",[cc.name,td.name]).service("windowService",function(){}).decorator("windowService",["$delegate","$injector",function(a,b){var c;Ob()?c="appWindowService":chrome&&chrome.extension?c="extensionWindowService":B("Unknown mode");return b.get(c)}]);var vd=function(a,b,c,d,e,g){this.cloudDevicesUrl=a;this.oauth2TokenUrl=b;this.oauth2RevokeUrl=c;this.appClientID=d;this.appClientSecret=e;this.unauthenticatedAccessKey=g},wd=function(a,b,c,d,e,g,h,k,w,Rb,ld){a=chrome&&chrome.runtime&&chrome.runtime.getManifest&&chrome.runtime.getManifest()||{oauth2:{}};vd.call(this,c,d,e,g,h,k,w,Rb,ld||a.oauth2.scopes)};l(wd,vd);
var xd=new wd("https://people-pa.googleapis.com/v2","https://classroom.googleapis.com/v1","https://www.googleapis.com/clouddevices/v1","https://accounts.google.com/o/oauth2/token","https://accounts.google.com/o/oauth2/revoke","919648714761-l7s11uoekiqlmod1oiv9tcjj2f1ca7dm.apps.googleusercontent.com","QVdYPt9YzQIEto4plJysXS_Z","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA","919648714761"),yd=new wd("https://people-pa.googleapis.com/v2","https://classroom.googleapis.com/v1","https://www.googleapis.com/clouddevices/v1",
"https://accounts.google.com/o/oauth2/token","https://accounts.google.com/o/oauth2/revoke","118015405293-cgi20hoev7ra87bbh1m06m50hjh0kn2f.apps.googleusercontent.com","vb85qOcIn3ePYVsM5eLyqGwa","AIzaSyBJmRs4E8liF60p2aqYrrwZKTFxjOUcRbQ","118015405293");
new wd("https://dev-people-pa.corp.googleapis.com/v2","https://classroom.googleapis.com/v1","https://www-googleapis-test.sandbox.google.com/clouddevices/v1","https://gaiastaging.corp.google.com/o/oauth2/token","https://gaiastaging.corp.google.com/o/oauth2/revoke","458680700438-rg3395orm9gjf4bpb92k0jp4t3kjmacd.apps.googleusercontent.com","u8KwlrFS1U3VCUvk-lpoCPb1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA","919648714761","1/cCRF0RdA8mz821hYrqxBsCx9tA7o-N8tX5TA4z0nHWRIgOrJDtdun6zK6XiATCKT");var zd=function(){this.logger=J("cv2.cloud.ChromeIdentityAuthProvider");this.getAuthToken_=P("chrome.identity.getAuthToken")};zd.prototype.getToken=function(){K(this.logger,"Getting OAuth token from Chrome identity.");return this.getTokenInternal(!0)};zd.prototype.getTokenInternal=function(a){return this.getAuthToken_({interactive:a})};var Ad=function(a){this.token_=a};Ad.prototype.getToken=function(){return O(this.token_)};
if("undefined"!=typeof angular)var Bd=angular.module("castv2.cloud.authProvider",[]).service("chromeIdentityAuthProvider",zd);var Cd=function(a,b){this.oauthClient_=a;this.storage_=b;this.logger_=J("cv2.receiver.cloud.DeviceAuthProvider")};Cd.prototype.getToken=function(){var a=this;K(this.logger_,"Using device OAuth credentials.");return this.storage_.getDeviceOAuth().then(function(b){if(!b)throw Error("No device credentials.");K(a.logger_,"Using stored device OAuth credentials.");return a.oauthClient_.requestAccessToken(b).then(function(c){return a.storage_.storeDeviceOAuth(c,b).then(function(){return c.accessToken})})})};
Cd.$inject=["oauthClient","storage"];var Dd=function(a){this.oauthClient_=new nd(yd);this.storage_=a;this.logger_=J("cv2.receiver.cloud.LegacyDeviceAuthProvider")};Dd.prototype.getToken=function(){var a=this;K(this.logger_,"Using legacy device OAuth credentials.");return this.storage_.getLegacyDeviceOAuth().then(function(b){if(!b)throw Error("No device credentials.");K(a.logger_,"Using stored legacy device OAuth credentials.");return a.oauthClient_.requestAccessToken(b).then(function(a){return a.accessToken})})};
Dd.$inject=["storage"];var Ed=function(a,b,c,d){this.chromeIdentityAuthProvider_=a;this.oauthClient_=b;this.storage_=c;this.windowService_=d;this.logger_=J("cv2.receiver.cloud.UserAuthProvider")};
Ed.prototype.getToken=function(){var a=this;return this.storage_.getUserAuthTokens().then(function(b){if(!b)return a.chromeIdentityAuthProvider_.getToken();K(a.logger_,"Using stored user OAuth credentials.");return a.oauthClient_.requestAccessToken(b).then(function(c){return a.storage_.storeUserAuthTokens(c,b).then(function(){return c.accessToken})})})};
Ed.prototype.revokeAccessToken=function(){var a=this;return this.storage_.getUserAuthTokens().then(function(b){return b?(K(a.logger_,"Revoking user OAuth credentials."),a.oauthClient_.revokeToken(b.refreshToken).then(function(){return a.storage_.deleteUserAuthTokens()})):null})};Ed.$inject=["chromeIdentityAuthProvider","oauthClient","storage","windowService"];
if("undefined"!=typeof angular)var Fd=angular.module("castv2.receiver.cloud.authProvider",[ud.name,Bd.name,od.name,qd.name]).service("deviceAuthProvider",Cd).service("legacyDeviceAuthProvider",Dd).service("userAuthProvider",Ed);var Gd=function(){this.receiverName=this.receiverId=null;this.sendAnalytics=!1;this.autoFullScreen=!0;this.backgroundImageOn=!1;this.backgroundImageUrls=[];this.backgroundImageMs=6E4;this.enableCopresence=!1};pa("castv2.cloud.devices.Settings.DEFAULT_BACKGROUND_IMAGE_MS",6E4,void 0);var Hd=function(a){this.base_=a;this.id=a.id;this.logger_=J("cv2.devices.CloudDevice")};Hd.prototype.getDisplayName=function(){return this.getState().settings.receiverName};Hd.prototype.getState=function(){return this.base_.state._cloudCast};
Hd.prototype.getSettings=function(){var a=new Gd;a.receiverName=this.getDisplayName();a.receiverId=this.id;var b=this.getState().settings||{};a.sendAnalytics=b.sendAnalytics||!1;a.autoFullScreen=b.autoFullScreen||!1;a.backgroundImageOn=b.backgroundImageOn||!1;a.backgroundImageUrls=b.backgroundImageUrls||[];a.backgroundImageMs=b.backgroundImageMs||6E4;a.enableCopresence=b.enableCopresence||!1;return a};Hd.prototype.toString=function(){return JSON.stringify(this.base_)};var Id=function(){this.nextSubscription_=null},Jd=function(){this.nextSubscription_=null;this.closed_=!1};l(Jd,Id);f=Jd.prototype;f.listen=function(a){a=new Kd(a);this.closed_||(a.nextSubscription_=this.nextSubscription_,this.nextSubscription_=a);return a};f.isDisposed=function(){return this.closed_};f.dispose=function(){this.closed_=!0;this.nextSubscription_=null};f.getStream=function(){return this};
f.send=function(a){if(this.closed_)throw Error("stream controller already disposed");for(var b=this;b;){var c=b.nextSubscription_;if(c)if(null==c.listener_)b.nextSubscription_=c.nextSubscription_;else try{c.listener_.call(null,a)}catch(d){Pa(d)}b=c}};var Kd=function(a){this.nextSubscription_=null;this.listener_=a};l(Kd,Id);Kd.prototype.isDisposed=function(){return null==this.listener_};Kd.prototype.dispose=function(){this.listener_=null};var Ld=function(){this.isOnline_=!1;this.onStateChangedCtrl_=new Jd;this.onStateChanged=this.onStateChangedCtrl_.getStream();this.logger_=J("cv2.OnlineState")};Ld.prototype.setOnline=function(a){a!=this.isOnline_&&(K(this.logger_,"Setting online state to "+a),this.isOnline_=a,this.onStateChangedCtrl_.send(a))};if("undefined"!=typeof angular)var Md=angular.module("castv2.receiver.OnlineState",[]).service("onlineState",Ld);var Nd=function(a){return"string"==typeof a?a:void 0},Od=function(a){A.call(this,t(a)?a:a.message);a="object"==typeof a?a:{};var b=a.code;this.code="number"==typeof b?b:void 0;this.domain=Nd(a.domain);this.status=Nd(a.status);b="unknown";"string"==typeof a.reason?b=a.reason:-1==this.code&&(b="network_error");this.reason=b};l(Od,A);Od.prototype.shouldRetry=function(){return!(Pd.has(this.reason)||Qd.has(this.status))};
var Pd=new Set("authError command_is_in_terminal_state forbidden notFound unmanaged_group_acl acl_entry_bad_scope network_error".split(" ")),Qd=new Set(["PERMISSION_DENIED"]);var Sd=function(a){var b=a.uri,c=a.baseUrl,d=a.pathParts,e=a.queryParams,g=a.authProvider,h=a.authToken,k=a.body,w=a.start;this.method=a.method;this.uri=b||Rd(c,d||null,e);this.authProvider=null!=h?new Ad(h):g||null;this.body=k||null;this.start=w||va()},Td=function(a,b,c){this.apiKey_=a.unauthenticatedAccessKey;this.gapiService_=b;this.onlineState_=c;this.nextId_=0;this.logger_=J("cv2.gapi.GapiServiceCaller")},Rd=function(a,b,c){var d=a;b&&b.forEach(function(a){d+="/"+encodeURIComponent(a)});a=new Zc(d);
c&&(c=id(c),a.setQueryData(c));return a};f=Td.prototype;
f.withTimeout_=function(a,b,c){var d=this,e=b.uri.toString().replace(/\?.*/,"?<redacted>"),g=b.method+" "+e;K(this.logger_,a+": "+g);e=Pc(1E4).then(function(){throw Error("GAPI call timed out");});return Gb([c,e]).then(function(c){var e=(va()-b.start)/1E3;K(d.logger_,a+" succeeded: "+g+" duration = "+e+"s");return c},function(b){var c=a+" failed: "+g;if(b instanceof Error)b.reason&&(c+=", reason: "+b.reason),b.status&&(c+=", status: "+b.status);else try{c+=", "+JSON.stringify(b)}catch(w){}yb(d.logger_,
c,b instanceof Error?b:null);throw b;})};f.execute=function(a,b){var c=this;b=void 0===b?null:b;var d="GAPI call "+this.nextId_++,e=function(){return c.withTimeout_(d,a,a.authProvider?c.getOAuth2Header_(a.authProvider).then(function(b){return c.callApi_(a,b)}):c.callApi_(a))};return(b?b.callWithExponentialBackoff(e,d):e()).thenCatch(function(a){a instanceof Od&&"network_error"==a.reason&&c.onlineState_.setOnline(!1);throw a;})};
f.callApi_=function(a,b){var c=this;a=this.formRequest_(a,void 0===b?null:b);var d=Jb();this.gapiService_.callApi(a,function(a,b){try{a&&!a.error||c.rawResponseSuccess_(b)?d.resolve(a):d.reject(c.parseError_(a,b))}catch(h){d.reject(h)}});return d.promise};f.parseError_=function(a,b){return a&&a.error?new Od(a.error.errors?a.error.errors[0]:a.error):b};f.getOAuth2Header_=function(a){return a.getToken().then(function(a){return{Authorization:"Bearer "+a}})};
f.rawResponseSuccess_=function(a){a=JSON.parse(a);return a.gapiRequest&&a.gapiRequest.data&&a.gapiRequest.data.status?0==(a.gapiRequest.data.status+"").lastIndexOf("2",0):!1};f.formRequest_=function(a,b){b||a.uri.setQueryData(id({key:this.apiKey_}));var c={method:a.method,path:a.uri.toString()};b&&(c.headers=b);a.body&&(c.body=a.body);return c};Td.$inject=["cloudConfig","gapiService","onlineState"];
if("undefined"!=typeof angular)var Ud=angular.module("castv2.gapi",[Md.name]).service("gapiServiceCaller",Td);var Vd=function(a,b){this.cloudDevicesUrl=a.cloudDevicesUrl;this.gapiServiceCaller_=b};Vd.prototype.callApi=function(a){return this.gapiServiceCaller_.execute(a)};Vd.$inject=["cloudConfig","gapiServiceCaller"];"undefined"!=typeof angular&&angular.module("castv2.devices",[Ud.name]).service("cloudDevices",Vd);var Wd=function(a,b,c,d){this.initialValue_=a;this.maxValue_=b;this.currBaseValue_=this.currValue_=a;this.randomFactor_=c||0;this.backoffFactor_=d||2};Wd.prototype.reset=function(){this.currBaseValue_=this.currValue_=this.initialValue_};
Wd.prototype.backoff=function(){this.currBaseValue_=Math.min(this.maxValue_,this.currBaseValue_*this.backoffFactor_);this.currValue_=Math.min(this.maxValue_,this.currBaseValue_+(this.randomFactor_?Math.round(this.randomFactor_*(Math.random()-.5)*2*this.currBaseValue_):0))};var Xd=function(a,b,c){b=void 0===b?null:b;c=void 0===c?null:c;this.numRetries_=a;null==b&&(b=500);null==c&&(c=1E3);this.backoffTimer_=new Wd(b,c,.15);this.logger_=J("cv2.common.ExponentialBackoff")};Xd.prototype.callWithExponentialBackoff=function(a,b){return this.callRecursive_(a,b,0,0)};
Xd.prototype.callRecursive_=function(a,b,c,d,e){var g=this;e=void 0===e?null:e;return e instanceof Od&&!e.shouldRetry()?(yb(this.logger_,"Giving up because of unrecoverable error: "+b),Db(e)):c>=this.numRetries_?(yb(this.logger_,"Giving up because retry limit reached: "+b),Db(e)):this.callAfterWaiting_(a,b,c,d).then(function(a){0<c&&K(g.logger_,"Succeeded after "+(c+1)+" attempts: "+b);g.backoffTimer_.reset();return a},function(d){var e=g.backoffTimer_.currValue_;g.backoffTimer_.backoff();return g.callRecursive_(a,
b,c+1,e,d)})};Xd.prototype.callAfterWaiting_=function(a,b,c,d){var e=this;return Pc(d).then(function(){0<c&&K(e.logger_,"Retrying (attempt "+(c+1)+" of "+e.numRetries_+"): "+b);return a()})};var Yd=function(a,b,c,d,e){Vd.call(this,c,d);this.deviceAuthProvider_=a;this.legacyDeviceAuthProvider_=b;this.receiverGapiServiceCaller_=d;this.storage_=e;this.receiverLogger_=J("cv2.devices.ReceiverDeviceService");this.lastRetrievedDevice_=null};l(Yd,Vd);f=Yd.prototype;f.callApi=function(a){return this.receiverGapiServiceCaller_.execute(a,new Xd(5,1E3,1E4))};
f.getDevice=function(a){var b=this;return this.callApi(new Sd({method:"GET",baseUrl:this.cloudDevicesUrl,pathParts:["devices",a],authProvider:this.deviceAuthProvider_})).then(function(a){b.lastRetrievedDevice_=a;return new Hd(b.lastRetrievedDevice_)})};f.deleteDevice=function(a,b){var c=this;return this.deleteDeviceWithRetry_(a,this.deviceAuthProvider_,b).then(function(a){return c.storage_.deleteDeviceId().then(function(){return a})})};
f.deleteLegacyDevice=function(a,b){var c=this;return this.deleteDeviceWithRetry_(a,this.legacyDeviceAuthProvider_,b).then(function(a){return c.storage_.deleteLegacyDeviceId().then(function(){return a})})};
f.deleteDevice_=function(a,b){var c=this;return this.callApi(new Sd({method:"DELETE",baseUrl:this.cloudDevicesUrl,pathParts:["devices",b],authProvider:a})).then(function(){c.lastRetrievedDevice_=null;return!0},function(a){if("notFound"==a.reason)return zb(c.receiverLogger_,"Device with ID "+b+" does not exist"),!1;throw a;})};
f.deleteDeviceWithRetry_=function(a,b,c){var d=this;return this.deleteDevice_(a,c).thenCatch(function(a){if("forbidden"==a.reason||"authError"==a.reason)return d.deleteDevice_(b,c);throw a;})};f.unregister=function(a){var b=this;return Hb([this.storage_.getDeviceId(),this.storage_.getLegacyDeviceId()]).then(function(c){var d=c[0];c=c[1];d=d?b.deleteDevice(a,d):O();c=c?b.deleteLegacyDevice(a,c):O();return Hb([d,c])}).then(function(){return a.revokeAccessToken()}).thenAlways(function(){b.storage_.deleteAll()})};
f.setUnavailable=function(a){var b={};b=(b._cloudCast={appStatus:"unavailable"},b);return this.patchDevice_(a,{state:b})};f.patchDevice_=function(a,b){var c=this;return this.callApi(new Sd({method:"PATCH",baseUrl:this.cloudDevicesUrl,pathParts:["devices",a],body:b,authProvider:this.deviceAuthProvider_})).then(function(a){c.lastRetrievedDevice_=a;return new Hd(c.lastRetrievedDevice_)})};Yd.$inject=["deviceAuthProvider","legacyDeviceAuthProvider","cloudConfig","gapiServiceCaller","storage"];
if("undefined"!=typeof angular)var Zd=angular.module("castv2.receiver.devices",[Ud.name,Fd.name,qd.name]).service("receiverDevices",Yd);var $d=function(){};$d.prototype.callApi=function(a,b){var c=this.newXmlHttpRequest();c.onreadystatechange=function(){4==c.readyState&&b(c.response,"text"==c.responseType?c.responseText:"")};c.open(a.method,a.path,!0);c.setRequestHeader("Content-type","application/json");c.responseType="json";c.setRequestHeader("Accept","application/json");for(var d in a.headers)c.setRequestHeader(d,a.headers[d]);c.send(JSON.stringify(a.body))};$d.prototype.newXmlHttpRequest=function(){return new XMLHttpRequest};var ae=function(a,b,c,d){this.launchEventService_=a;this.storage_=b;this.receiverDevices_=c;this.windowService_=d;this.checkOpenResolver_=null};f=ae.prototype;f.start=function(){var a=this;this.listenToLaunch_();this.setUnavailableOnStartup_();this.listenForCommands_();this.storage_.getForceLaunch().then(function(b){b&&a.openApp_(!1)}).thenAlways(function(){a.storage_.deleteForceLaunch()})};
f.setUnavailableOnStartup_=function(){var a=this;Q(chrome.runtime.onStartup,function(){a.checkOpenResolver_=Jb();a.storage_.getDeviceId().then(function(b){(b?a.receiverDevices_.setUnavailable(b):O()).then(function(){a.checkOpenResolver_.resolve()})})})};f.listenToLaunch_=function(){var a=this;this.launchEventService_.subscribe(Tb,function(b){(a.checkOpenResolver_?a.checkOpenResolver_.promise:O()).then(function(){a.openApp_(b)})})};
f.listenForCommands_=function(){var a=this;Q(chrome.commands.onCommand,function(b){return a.commandHandler_(b)})};f.commandHandler_=function(a){switch(a){case "exit-app":this.windowService_.closeApp();break;default:B("Unknown command: "+a)}};f.openApp_=function(a){this.openLocalWindow_(a)};
f.openLocalWindow_=function(a){var b=this,c=chrome.runtime.getManifest().name;a&&(c="KIOSK: "+c);this.windowService_.create(Ob()?"window_application.html":"window_extension.html",c,be()).then(function(a){a.subscribe($b,function(){b.storage_.getDeviceId().then(function(a){a&&b.receiverDevices_.setUnavailable(a)})})})};var be=function(){var a=Math.floor(.8*window.screen.width);return{width:a,height:Math.floor(9*a/16)}};ae.$inject=["launchEventService","storage","receiverDevices","windowService"];var ce=angular.module("castv2.receiver.eventPage",[Zd.name,qd.name,Zb.name,ud.name]).constant("gapiService",new $d).constant("cloudConfig",xd).service("backgroundService",ae),de=function(a){a.start()};de.$inject=["backgroundService"];ce.run(de);angular.injector([ce.name]);angular.module("castv2.templates",[]).value("forceCachedTemplates",!1).value("forceUncachedTemplates",!1).factory("html2JsTemplatesCached",["forceCachedTemplates","forceUncachedTemplates",function(a,b){return function(){return!b&&!0}}]).run(["$templateCache","html2JsTemplatesCached",function(a,b){b()&&(a.put("integration.html",'<!DOCTYPE html>\n<html lang="en" ng-app="castv2.receiver.integration" ng-csp>\n  <head>\n    <meta charset="utf-8">\n    <title>Integration Test</title>\n    <script src="angular.min.js" type="text/javascript">\x3c/script>\n    <script src="integration_script.js" type="text/javascript">\x3c/script>\n  </head>\n  <body ng-controller="IntegrationCtrl as ctrl">\n    <div id="device-registered"\n         ng-show="ctrl.deviceRegistered">registered</div>\n    <div id="device-patched"\n         ng-show="ctrl.devicePatched">device patched</div>\n    <div ng-show="ctrl.devicesFound">devices found: {{ctrl.devicesFound}}</div>\n    <div id="device-found"\n         ng-show="ctrl.registeredDeviceFound">registered device found</div>\n    <div id="acls-found"\n         ng-show="ctrl.aclsFound">default ACLs found</div>\n    <div id="device-unregistered"\n         ng-show="ctrl.deviceUnregistered">unregistered</div>\n    <div id="tests-completed"\n         ng-show="ctrl.testsCompleted">tests completed</div>\n    <div ng-show="ctrl.step">current step: {{ctrl.step}}</div>\n    <div id="error-message">{{ctrl.errorMessage}}</div>\n    <iframe id="gapi-sandbox" src="sandbox.html"></iframe>\n  </body>\n</html>\n'),
a.put("sandbox.html",'<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="utf-8">\n  <div>\n    <script type="text/javascript" src="sandbox_script.js">\x3c/script>\n    <script type="text/javascript" src="sandbox_extra.js">\n    \x3c/script>\n    <script type="text/javascript"\n            src="https://apis.google.com/js/client.js?onload=handleClientScriptLoaded">\x3c/script>\n  </div>\n</head>\n</html>\n'),a.put("window_application.html",'<!DOCTYPE html>\n<html lang="en" ng-app="castv2.receiver.app" ng-csp ng-strict-di>\n  <head>\n    <meta charset="utf-8">\n    <title>Google Cast for Education</title>\n    <script src="angular.min.js" type="text/javascript">\x3c/script>\n    <script src="controller_script.js" type="text/javascript">\x3c/script>\n    <link rel="stylesheet" type="text/css" href="bootstrap_css-bundle.css">\n    <link rel="stylesheet" type="text/css" href="material_css_min.css">\n    <link rel="stylesheet" type="text/css" href="css.css">\n  </head>\n  <body>\n    <webview class="invisible" id="gapi-sandbox" src="sandbox.html" partition="persist:static">\n    </webview>\n    <div id="ui-view" ui-view></div> \x3c!-- The view which angular will replace with sub-templates --\x3e\n  </body>\n</html>\n'),
a.put("window_extension.html",'<!DOCTYPE html>\n<html lang="en" ng-app="castv2.receiver.app" ng-csp ng-strict-di>\n  <head>\n    <meta charset="utf-8">\n    <title>Google Cast for Education</title>\n    <script src="angular.min.js" type="text/javascript">\x3c/script>\n    <script src="controller_script.js" type="text/javascript">\x3c/script>\n    <link rel="stylesheet" type="text/css" href="bootstrap_css-bundle.css">\n    <link rel="stylesheet" type="text/css" href="material_css_min.css">\n    <link rel="stylesheet" type="text/css" href="css.css">\n  </head>\n  <body>\n    <iframe class="invisible" id="gapi-sandbox" src="sandbox.html" partition="persist:static">\n    </iframe>\n    <div id="ui-view" ui-view></div> \x3c!-- The view which angular will replace with sub-templates --\x3e\n  </body>\n</html>\n'))}]);var fe=function(){this.privateDoNotAccessOrElseSafeScriptWrappedValue_="";this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=ee};fe.prototype.implementsGoogStringTypedString=!0;var ee={};fe.prototype.toString=function(){return"SafeScript{"+this.privateDoNotAccessOrElseSafeScriptWrappedValue_+"}"};
var ge=function(a){if(a instanceof fe&&a.constructor===fe&&a.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===ee)return a.privateDoNotAccessOrElseSafeScriptWrappedValue_;B("expected object of type SafeScript, got '"+a+"' of type "+v(a));return"type_error:SafeScript"};var ie=function(){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_="";this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=he};ie.prototype.implementsGoogStringTypedString=!0;ie.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"};
var je=function(a){if(a instanceof ie&&a.constructor===ie&&a.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===he)return a.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;B("expected object of type TrustedResourceUrl, got '"+a+"' of type "+v(a));return"type_error:TrustedResourceUrl"},he={};var le=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=ke};le.prototype.implementsGoogStringTypedString=!0;le.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"};
var me=function(a){if(a instanceof le&&a.constructor===le&&a.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===ke)return a.privateDoNotAccessOrElseSafeHtmlWrappedValue_;B("expected object of type SafeUrl, got '"+a+"' of type "+v(a));return"type_error:SafeUrl"},ke={};var oe=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="";this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=ne};oe.prototype.implementsGoogStringTypedString=!0;var ne={};oe.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"};
var pe=function(a){if(a instanceof oe&&a.constructor===oe&&a.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===ne)return a.privateDoNotAccessOrElseSafeStyleWrappedValue_;B("expected object of type SafeStyle, got '"+a+"' of type "+v(a));return"type_error:SafeStyle"};var re=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=qe};re.prototype.implementsGoogStringTypedString=!0;re.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"};
var se=function(a){if(a instanceof re&&a.constructor===re&&a.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===qe)return a.privateDoNotAccessOrElseSafeHtmlWrappedValue_;B("expected object of type SafeHtml, got '"+a+"' of type "+v(a));return"type_error:SafeHtml"},qe={};pa("ng.safehtml.googSceHelper.isGoogHtmlType",function(a){return a&&a.implementsGoogStringTypedString?!0:!1},void 0);pa("ng.safehtml.googSceHelper.isCOMPILED",function(){return!0},void 0);pa("ng.safehtml.googSceHelper.unwrapAny",function(a){if(a instanceof ie)return je(a);if(a instanceof re)return se(a);if(a instanceof le)return me(a);if(a instanceof oe)return pe(a);if(a instanceof fe)return ge(a);throw Error();},void 0);
pa("ng.safehtml.googSceHelper.unwrapGivenContext",function(a,b){if("html"==a)return se(b);if("resourceUrl"==a||"templateUrl"==a)return je(b);if("url"==a)return b instanceof ie?je(b):me(b);if("css"==a)return pe(b);if("js"==a)return ge(b);throw Error();},void 0);
